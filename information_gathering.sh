#!/bin/bash
# information_gathering.sh
# Arguments : IP or dns / output folder
# Example : ./information_gathering.sh google.com gathering_google
# This file create gathering_google folder if he doesn't exist and put the information gathering report in this folder :)
# This script use the following tools :
#	- dnsenum
#	- dmitry
#
#
#

echo "#################################################################################################"
echo "#   				  Information gathering script					#"
echo "#  		  This script perform simple information garthing on target			#"
echo "#    			  WARNING : This script isn't final					#"
echo "#         		 	  Copyleft Gilles Dubois		   			#"
echo "#################################################################################################"

echo ""
echo "[*] Check..."

if [ "$#" -ne 2 ]; then
	echo ""
    echo " [-] Illegal number of parameters !"
    echo " [-] Leaving."
    exit
fi

array=( "dnsenum" "fierce" "dmitry" "netmask" )

for i in "${array[@]}"
do
	if ! type $i > /dev/null; then
		# Tool isn't installed
		echo " [-]" $i " isn't installed !!!!"
		echo " [-] Leaving."
		exit
	fi
done

if [ ! -d $2 ]; then
  # Control will enter here if $2 dir doesn't exist.
  echo " [*]" $2 "directory doesn't exist"
  echo " [*] Creating" $2 "..."
  mkdir $2
  if [ $? -ne 0 ] ; then
    echo " [-] Can't create directory, check your permissions !!"
    echo " [-] Leaving."
    exit
  else
    echo "[*] Directory created successfully ;-)"
  fi
else
  echo " [*] Directory already exist"
  echo " [*] Nothing to do ..."
fi


echo ""
echo " [*] Arg OK ! ;-) "
echo " [*] Let's gethering some informations from " $1
echo ""
echo "[*] All the output of these commands will be stored in differents files (One per used tools)"
#########################################
echo ""
echo " [*] Launching dnsenum"

dnsenum --enum $1 > $2"/dnsenum.txt"
 
echo " [*] dnsenum succesfully excuted !"
echo " [*] Output in" $2"/dnsenum.txt"
#########################################
echo ""
echo " [*] Launching fierce"

fierce -dns $1 -file $2"/fierce.txt"

echo " [*] dnsenum succesfully excuted !"
echo " [*] Output in" $2"/fierce.txt"
#########################################
echo ""
echo " [*] Launching dmitry"

dmitry -wnspb $1 -o $2"/dmitry"

echo " [*] dnsenum succesfully excuted !"
echo " [*] Output in" $2"/dmitry.txt"
#########################################
echo ""
echo " [*] Launching netmask"

netmask -s $1 -o $2"/netmask.txt"

echo " [*] dnsenum succesfully excuted !"
echo " [*] Output in" $2"/dmitry.txt"
#########################################
echo "[*] Finished."
